# Nodejs 책리뷰사이트 팀프로젝트

### https://github.com/zam0ng/node-PJ.git

## 20230602

- 작가로 등록된 사람은 자신의 책을 올릴수 있고 독자들은 책에 대한 리뷰를 작성할 수 있는 사이트를 구현하기로함
- 그 중 상세페이지와 실시간 채팅 기능에 대한 구현부분을 맡음

### 금일 작업 내용

- users, books, review, r_review 테이블 생성 및 조인 sequelize js 파일 생성 후 배포

## 20230604

- chat 테이블 생성 js 작성 및 테스트 쿼리 작성

### 추후 추가 사항

- 테이블 생성 후 테스트 진행 결과 특정 유저와 어드민의 대화를 특정유저의 채팅 시간 정보를 이용하여 가져오지만 다른 유저의 대화가 사이에 껴있으면 다른 유저에 대한 어드민에 답변도 가져와 지는 현상발견
- user_name, text 컬럼 뿐만이 아닌 별도의 컬럼이 필요

## 20230605

- books 테이블 조회수 탑 5 리스트를 가져오기 위해 viewcnt 컬럼 추가
- users 테이블 컬럼 중 check 컬럼이 예약되있는 언어 이기 때문에 checks로 컬럼명 변경
- 메인 페이지 조회수 탑 5 리스트 및 별점 탑 5 리스트 정보를 가져오는 메인 페이지 구현 완료

## 20230606

- 나작작 프로젝트에 사용할 실시간 채팅 기능 관련 socket.io 개인 공부 실시
- mysql 쿼리를 sequelize로 바꾸는데 어려움이 있어 sequelize 문법에 대한 개인 공부 실시

## 20230607

- 나작작 프로젝트 상세페이지 css 작업 진행
- 별점 평균, 별점 별 평균, 유저에 대한 정보를 불러오는 기능에 대해선 내일부터 작업 진행할 예정
- position sticky 나 height:auto 설정이 되지 않은 문제가 발생하여 시간을 많이 뻇김
- -> 최상단 부모 태그 아래 태그에 display:flex를 사용하여 발생한 문제 무분별한 flex 사용을 자제 하고 display와 position에 대해 알아볼 예정

## 20230608

- 나작작 프로젝트 상세페이지 기능 구현 작업 중
- 해당 페이지의 게시글에 대한 내용 및 작가의 정보를 불러오는 sequelize 작업 진행

## 20230609

- 나작작 프로젝트 상세페이지 기능 구현 작업 중
- 상세페이지 별점, 댓글수, 작성 글 정보 불러오기, 작가 정보 불러오기, 댓글 쓰기, 리뷰 통계 그래프 기능 구현 완료
- 해당 글에 있는 댓글을 작성한 닉네임 정보를 가져와 users 테이블에 접근하려 할때 계속 글쓴 작가의 정보만 가져와짐
- -> 테이블에 조인 조건에 의해 안되는거 같음 테이블 수정필요
- -> review 테이블에 유저 프로필 이미지등 간단한 정보를 추가해도 문제는 해결됨

## 20230610

- 나작작 프로젝트 상세페이지 댓글쓴 사람 프로필 불러오는 쿼리 테스트
- 대댓글은 버튼을 누르면 보여지게끔 css 변경

## 20230611

- 나작작 프로젝트 상세페이지 버그 수정 및 데이터베이스 변경
- 데이터베이스 users 테이블과 review 테이블을 조인 시키기 위해 models 조인조건 추가
- 추가 후 테스트를 하기 위해 테스트 데이터를 넣는 도중 별점 정보가 아예 없거나 비어 있을때 생기는 버그 발견

---

> 별점 정보가 아예 없을때

- 새로 등록한 책의 경우 별점 및 댓글 정보가 아무것도 없을 수 있음
- 별점에 대한 정보가 없을 경우 모든 경우의 수를 0으로 하는 기능 추가
  > 별점이 중간에 비는 경우
- 별점이 5,3,1 각 1개씩 있다고 가정했을때 4,2 에 대한 별점정보가 비게되는데 별점 통계에서는 5,4,3,2,1 순으로 별점을 가져와 그래프를 그려주는데 3개의 데이터만 들어오기 때문에 위에서 부터 3개 데이터 입력후 나머지 2개는 undefined
- 무조건 5번 동작하는 for문을 추가하여 비어있는 별점에 0을 추가함

## 20230612

- 나작작 프로젝트 상세페이지 버그 수정 및 데이터베이스 변경
- review 테이블과 users 테이블 연결 후 review는 사용자 이미지를 불러와 졌지만 r_review 즉 대댓글 기능에 유저 이미지가 불러와지지 않아 users 테이블과 r_review 테이블 조인 조건 추가
- 별점 점수가 어제 테스트했을때는 몰랐는데 여러개가 비었을때 다른 버그가 발생함
- 1,2,3,4,5 가 전부 들어있는 배열을 미리 만들어두고 넘어온 별점의 길이가 5가 아니면 미리 만들어 둔 배열에 넘어온 데이터를 삽입 하는 식으로 수정
- 대댓글 comment 버튼 누르면 보였다 안보였다 하게 작업 중

## 20230613

- 나작작 프로젝트 상세페이지 작업
- 댓글 및 대댓글 기능 별점 통계 기능 구현완료
- 다른 페이지와 merge 작업 중 전체 목록에서 해당 게시물로 넘어갈때 게시물의 id값을 넘겨주는 작업 필요
